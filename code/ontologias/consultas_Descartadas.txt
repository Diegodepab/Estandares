Consultas SPARQL GRUPO 3 utilizando el archivo ontology_turtle.ttl

### Consulta1: Lista de tratamientos realizados en cada Hospital, y el número de veces que se han realizado. (Podemos hacer que se muestre solo los de más de 1 vez.

PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX meda_error: <http://www.semanticweb.org/ontologies/2024/10/proyectoEstandares/tratamiento_hecho_en_hospital#> 

SELECT ?hospital ?tipoTratamiento (COUNT(?tratamiento) AS ?numTratamientos)
WHERE {
  ?tratamiento rdf:type <http://www.semanticweb.org/ontologies/2024/10/proyectoEstandares/Tratamiento> .
  ?tratamiento <http://www.semanticweb.org/ontologies/2024/10/proyectoEstandares/tratamiento_hecho_en_hospital> ?hospital .
  ?tratamiento <http://www.semanticweb.org/ontologies/2024/10/proyectoEstandares/tipo_de_tratamiento> ?tipoTratamiento .
}
GROUP BY ?hospital ?tipoTratamiento
ORDER BY ?hospital


### Consulta 2: obtener     dni, fecha_nacimiento, sexo, etnia e informacion_contactomayores de 50 que han recibido un tratamiento de Diabetes Tipo 2.

PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT ?dni ?fechaNacimiento ?sexo ?etnia ?informacionContacto
WHERE {
  ?paciente rdf:type <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/Paciente> .
  ?paciente <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/paciente_dni> ?dni .
  ?paciente <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/paciente_fecha_nacimiento> ?fechaNacimiento .
  ?paciente <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/paciente_sexo> ?sexo .
  ?paciente <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/paciente_etnia> ?etnia .
  ?paciente <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/paciente_informacion_contacto> ?informacionContacto .

  ?tratamiento rdf:type <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/Tratamiento> .
  ?tratamiento <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/tratamiento_aplicado_a_paciente> ?paciente .
  ?tratamiento <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/tipo_de_tratamiento> "Diabetes Tipo 2" .

  # Filter patients older than 50 years
  FILTER (year(now()) - year(?fechaNacimiento) > 50)
}

### Consulta 3: Obtener el identificador, el nombre y la descripcion de los tratamientos junto al nombre y sintomas de las enfermedades asociadas, además de la edad media de los pacientes que tienen dichos tratamientos

PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT ?tratamientoID ?nombreTratamiento ?descripcionTratamiento ?nombreEnfermedad ?sintomasEnfermedad (AVG(year(now()) - year(?fechaNacimiento)) AS ?edadMedia)
WHERE {
  # Tratamiento y sus propiedades
  ?tratamiento rdf:type <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/Tratamiento> .
  ?tratamiento <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/tratamiento_id> ?tratamientoID .
  ?tratamiento <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/tratamiento_nombre> ?nombreTratamiento .
  ?tratamiento <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/tratamiento_descripcion> ?descripcionTratamiento .

  # Enfermedad asociada al tratamiento y sus propiedades
  ?tratamiento <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/tratamiento_para_enfermedad> ?enfermedad .
  ?enfermedad <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/enfermedad_nombre> ?nombreEnfermedad .
  ?enfermedad <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/enfermedad_sintomas> ?sintomasEnfermedad .

  # Relación del tratamiento con los pacientes
  ?tratamiento <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/tratamiento_aplicado_a_paciente> ?paciente .
  ?paciente <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/paciente_fecha_nacimiento> ?fechaNacimiento .
  
  # Calcular la edad media
}
GROUP BY ?tratamientoID ?nombreTratamiento ?descripcionTratamiento ?nombreEnfermedad ?sintomasEnfermedad
ORDER BY ?tratamientoID

Consulta 4: Listar Lo nombres de los pacientes que tienen tratamientos que tengan un régimen de duración de días mayor a 30 días 
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT ?nombrePaciente
WHERE {
  # Tratamiento y su duración
  ?tratamiento rdf:type <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/Tratamiento> .
  ?tratamiento <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/tratamiento_duracion_dias> ?duracion .
  
  # Relación del tratamiento con el paciente
  ?tratamiento <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/tratamiento_aplicado_a_paciente> ?paciente .
  ?paciente <http://www.semanticweb.org/alex/ontologies/2024/10/untitled-ontology-14/paciente_nombre> ?nombrePaciente .

  # Filtrar tratamientos con duración mayor a 30 días
  FILTER (?duracion > 30)
}
ORDER BY ?nombrePaciente
